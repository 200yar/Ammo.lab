'use strict';var THREE,list,extensions,numDiv,data,TextDecoder;var ARRAY8;ARRAY8||(ARRAY8="undefined"!==typeof Uint8Array?Uint8Array:Array);function Perlin(a){this.F2=0.5*(Math.sqrt(3)-1);this.G2=(3-Math.sqrt(3))/6;a||(a=Math.random);this.p=new ARRAY8(256);this.perm=new ARRAY8(512);this.permMod12=new ARRAY8(512);for(var c=0;256>c;c++)this.p[c]=256*a();for(c=0;512>c;c++)this.perm[c]=this.p[c&255],this.permMod12[c]=this.perm[c]%12}
Perlin.prototype={grad3:new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),noise:function(a,c){var e=this.permMod12,f=this.perm,d=this.grad3,g=0,h=0,k=0,l=(a+c)*this.F2,n=Math.floor(a+l),u=Math.floor(c+l),l=(n+u)*this.G2,r=a-(n-l),w=c-(u-l),x,b;r>w?(x=1,b=0):(x=0,b=1);var v=r-x+this.G2,y=w-b+this.G2,l=r-1+2*this.G2,q=w-1+2*this.G2,n=n&255,u=u&255,m=0.5-r*r-w*w;0<=m&&(g=3*e[n+f[u]],m*=m,g=m*m*(d[g]*r+d[g+1]*w));r=0.5-v*v-y*y;0<=r&&(h=3*e[n+x+f[u+
b]],r*=r,h=r*r*(d[h]*v+d[h+1]*y));v=0.5-l*l-q*q;0<=v&&(e=3*e[n+1+f[u+1]],v*=v,k=v*v*(d[e]*l+d[e+1]*q));return 70*(g+h+k)}};THREE.OrbitControls=function(a,c){function e(){return Math.pow(0.95,b.zoomSpeed)}function f(a){b.object instanceof THREE.PerspectiveCamera?z/=a:b.object instanceof THREE.OrthographicCamera?(b.object.zoom=Math.max(b.minZoom,Math.min(b.maxZoom,b.object.zoom*a)),b.object.updateProjectionMatrix(),L=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),b.enableZoom=!1)}function d(a){b.object instanceof THREE.PerspectiveCamera?z*=a:b.object instanceof THREE.OrthographicCamera?
(b.object.zoom=Math.max(b.minZoom,Math.min(b.maxZoom,b.object.zoom/a)),b.object.updateProjectionMatrix(),L=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),b.enableZoom=!1)}function g(a){if(!1!==b.enabled){a.preventDefault();if(a.button===b.mouseButtons.ORBIT){if(!1===b.enableRotate)return;A.set(a.clientX,a.clientY);p=m.ROTATE}else if(a.button===b.mouseButtons.ZOOM){if(!1===b.enableZoom)return;B.set(a.clientX,a.clientY);p=m.DOLLY}else if(a.button===
b.mouseButtons.PAN){if(!1===b.enablePan)return;C.set(a.clientX,a.clientY);p=m.PAN}p!==m.NONE&&(document.addEventListener("mousemove",h,!1),document.addEventListener("mouseup",k,!1),b.dispatchEvent(y))}}function h(a){!1!==b.enabled&&(a.preventDefault(),p===m.ROTATE?!1!==b.enableRotate&&(D.set(a.clientX,a.clientY),E.subVectors(D,A),a=b.domElement===document?b.domElement.body:b.domElement,s.theta-=2*Math.PI*E.x/a.clientWidth*b.rotateSpeed,s.phi-=2*Math.PI*E.y/a.clientHeight*b.rotateSpeed,A.copy(D),b.update()):
p===m.DOLLY?!1!==b.enableZoom&&(F.set(a.clientX,a.clientY),G.subVectors(F,B),0<G.y?f(e()):0>G.y&&d(e()),B.copy(F),b.update()):p===m.PAN&&!1!==b.enablePan&&(H.set(a.clientX,a.clientY),I.subVectors(H,C),J(I.x,I.y),C.copy(H),b.update()))}function k(a){!1!==b.enabled&&(document.removeEventListener("mousemove",h,!1),document.removeEventListener("mouseup",k,!1),b.dispatchEvent(q),p=m.NONE)}function l(a){!1===b.enabled||!1===b.enableZoom||p!==m.NONE&&p!==m.ROTATE||(a.preventDefault(),a.stopPropagation(),
0>a.deltaY?d(e()):0<a.deltaY&&f(e()),b.update(),b.dispatchEvent(y),b.dispatchEvent(q))}function n(a){if(!1!==b.enabled&&!1!==b.enableKeys&&!1!==b.enablePan)switch(a.keyCode){case b.keys.UP:J(0,b.keyPanSpeed);b.update();break;case b.keys.BOTTOM:J(0,-b.keyPanSpeed);b.update();break;case b.keys.LEFT:J(b.keyPanSpeed,0);b.update();break;case b.keys.RIGHT:J(-b.keyPanSpeed,0),b.update()}}function u(a){if(!1!==b.enabled){switch(a.touches.length){case 1:if(!1===b.enableRotate)return;A.set(a.touches[0].pageX,
a.touches[0].pageY);p=m.TOUCH_ROTATE;break;case 2:if(!1===b.enableZoom)return;var c=a.touches[0].pageX-a.touches[1].pageX;a=a.touches[0].pageY-a.touches[1].pageY;c=Math.sqrt(c*c+a*a);B.set(0,c);p=m.TOUCH_DOLLY;break;case 3:if(!1===b.enablePan)return;C.set(a.touches[0].pageX,a.touches[0].pageY);p=m.TOUCH_PAN;break;default:p=m.NONE}p!==m.NONE&&b.dispatchEvent(y)}}function r(a){if(!1!==b.enabled)switch(a.preventDefault(),a.stopPropagation(),a.touches.length){case 1:if(!1===b.enableRotate)break;if(p!==
m.TOUCH_ROTATE)break;D.set(a.touches[0].pageX,a.touches[0].pageY);E.subVectors(D,A);var c=b.domElement===document?b.domElement.body:b.domElement;s.theta-=2*Math.PI*E.x/c.clientWidth*b.rotateSpeed;s.phi-=2*Math.PI*E.y/c.clientHeight*b.rotateSpeed;A.copy(D);b.update();break;case 2:if(!1===b.enableZoom)break;if(p!==m.TOUCH_DOLLY)break;c=a.touches[0].pageX-a.touches[1].pageX;a=a.touches[0].pageY-a.touches[1].pageY;c=Math.sqrt(c*c+a*a);F.set(0,c);G.subVectors(F,B);0<G.y?d(e()):0>G.y&&f(e());B.copy(F);
b.update();break;case 3:if(!1===b.enablePan)break;if(p!==m.TOUCH_PAN)break;H.set(a.touches[0].pageX,a.touches[0].pageY);I.subVectors(H,C);J(I.x,I.y);C.copy(H);b.update();break;default:p=m.NONE}}function w(a){!1!==b.enabled&&(b.dispatchEvent(q),p=m.NONE)}function x(a){a.preventDefault()}this.object=a;this.domElement=void 0!==c?c:document;this.enabled=!0;this.target=new THREE.Vector3;this.minDistance=0;this.maxDistance=Infinity;this.minZoom=0;this.maxZoom=Infinity;this.minPolarAngle=0;this.maxPolarAngle=
Math.PI;this.minAzimuthAngle=-Infinity;this.maxAzimuthAngle=Infinity;this.enableDamping=!1;this.dampingFactor=0.25;this.enableZoom=!0;this.zoomSpeed=1;this.enableRotate=!0;this.rotateSpeed=1;this.enablePan=!0;this.keyPanSpeed=7;this.autoRotate=!1;this.autoRotateSpeed=2;this.enableKeys=!0;this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT};this.target0=this.target.clone();this.position0=this.object.position.clone();this.zoom0=
this.object.zoom;this.getPolarAngle=function(){return t.phi};this.getAzimuthalAngle=function(){return t.theta};this.reset=function(){b.target.copy(b.target0);b.object.position.copy(b.position0);b.object.zoom=b.zoom0;b.object.updateProjectionMatrix();b.dispatchEvent(v);b.update();p=m.NONE};this.update=function(){var c=new THREE.Vector3,d=(new THREE.Quaternion).setFromUnitVectors(a.up,new THREE.Vector3(0,1,0)),e=d.clone().inverse(),f=new THREE.Vector3,g=new THREE.Quaternion;return function(){var a=
b.object.position;c.copy(a).sub(b.target);c.applyQuaternion(d);t.setFromVector3(c);b.autoRotate&&p===m.NONE&&(s.theta-=2*Math.PI/60/60*b.autoRotateSpeed);t.theta+=s.theta;t.phi+=s.phi;t.theta=Math.max(b.minAzimuthAngle,Math.min(b.maxAzimuthAngle,t.theta));t.phi=Math.max(b.minPolarAngle,Math.min(b.maxPolarAngle,t.phi));t.makeSafe();t.radius*=z;t.radius=Math.max(b.minDistance,Math.min(b.maxDistance,t.radius));b.target.add(M);c.setFromSpherical(t);c.applyQuaternion(e);a.copy(b.target).add(c);b.object.lookAt(b.target);
!0===b.enableDamping?(s.theta*=1-b.dampingFactor,s.phi*=1-b.dampingFactor):s.set(0,0,0);z=1;M.set(0,0,0);return L||f.distanceToSquared(b.object.position)>K||8*(1-g.dot(b.object.quaternion))>K?(b.dispatchEvent(v),f.copy(b.object.position),g.copy(b.object.quaternion),L=!1,!0):!1}}();this.dispose=function(){b.domElement.removeEventListener("contextmenu",x,!1);b.domElement.removeEventListener("mousedown",g,!1);b.domElement.removeEventListener("wheel",l,!1);b.domElement.removeEventListener("touchstart",
u,!1);b.domElement.removeEventListener("touchend",w,!1);b.domElement.removeEventListener("touchmove",r,!1);document.removeEventListener("mousemove",h,!1);document.removeEventListener("mouseup",k,!1);window.removeEventListener("keydown",n,!1)};var b=this,v={type:"change"},y={type:"start"},q={type:"end"},m={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},p=m.NONE,K=1E-6,t=new THREE.Spherical,s=new THREE.Spherical,z=1,M=new THREE.Vector3,L=!1,A=new THREE.Vector2,D=new THREE.Vector2,
E=new THREE.Vector2,C=new THREE.Vector2,H=new THREE.Vector2,I=new THREE.Vector2,B=new THREE.Vector2,F=new THREE.Vector2,G=new THREE.Vector2,N=function(){var a=new THREE.Vector3;return function(b,c){a.setFromMatrixColumn(c,0);a.multiplyScalar(-b);M.add(a)}}(),O=function(){var a=new THREE.Vector3;return function(b,c){a.setFromMatrixColumn(c,1);a.multiplyScalar(b);M.add(a)}}(),J=function(){var a=new THREE.Vector3;return function(c,d){var e=b.domElement===document?b.domElement.body:b.domElement;if(b.object instanceof
THREE.PerspectiveCamera){a.copy(b.object.position).sub(b.target);var f=a.length(),f=f*Math.tan(b.object.fov/2*Math.PI/180);N(2*c*f/e.clientHeight,b.object.matrix);O(2*d*f/e.clientHeight,b.object.matrix)}else b.object instanceof THREE.OrthographicCamera?(N(c*(b.object.right-b.object.left)/b.object.zoom/e.clientWidth,b.object.matrix),O(d*(b.object.top-b.object.bottom)/b.object.zoom/e.clientHeight,b.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),
b.enablePan=!1)}}();b.domElement.addEventListener("contextmenu",x,!1);b.domElement.addEventListener("mousedown",g,!1);b.domElement.addEventListener("wheel",l,!1);b.domElement.addEventListener("touchstart",u,!1);b.domElement.addEventListener("touchend",w,!1);b.domElement.addEventListener("touchmove",r,!1);window.addEventListener("keydown",n,!1);this.update()};THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype);THREE.OrbitControls.prototype.constructor=THREE.OrbitControls;
Object.defineProperties(THREE.OrbitControls.prototype,{center:{get:function(){console.warn("THREE.OrbitControls: .center has been renamed to .target");return this.target}},noZoom:{get:function(){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.");return!this.enableZoom},set:function(a){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.");this.enableZoom=!a}},noRotate:{get:function(){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.");
return!this.enableRotate},set:function(a){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.");this.enableRotate=!a}},noPan:{get:function(){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.");return!this.enablePan},set:function(a){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.");this.enablePan=!a}},noKeys:{get:function(){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.");
return!this.enableKeys},set:function(a){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.");this.enableKeys=!a}},staticMoving:{get:function(){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.");return!this.enableDamping},set:function(a){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.");this.enableDamping=!a}},dynamicDampingFactor:{get:function(){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.");
return this.dampingFactor},set:function(a){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.");this.dampingFactor=a}}});THREE.CapsuleBufferGeometry=function(a,c,e,f){THREE.BufferGeometry.call(this);this.type="CapsuleBufferGeometry";a=a||1;c=c||1;var d=e||12,g=0.5*~~d;e=f||1;var h=2*Math.PI,k=0.5*Math.PI;f=new THREE.Geometry;e=new THREE.CylinderGeometry(a,a,c,d,e,!0);var l=new THREE.SphereGeometry(a,d,g,0,h,0,k);a=new THREE.SphereGeometry(a,d,g,0,h,k,k);d=(new THREE.Matrix4).makeTranslation(0,0,0);g=(new THREE.Matrix4).makeTranslation(0,0.5*c,0);c=(new THREE.Matrix4).makeTranslation(0,0.5*-c,0);f.merge(e,d);f.merge(l,
g);f.merge(a,c);f.mergeVertices();this.fromGeometry(f)};THREE.CapsuleBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.CapsuleBufferGeometry.prototype.constructor=THREE.CapsuleBufferGeometry;THREE.ConvexGeometry=function(a){function c(c){var d=a[c].clone(),e=d.length();d.x+=2E-6*e*(Math.random()-0.5);d.y+=2E-6*e*(Math.random()-0.5);d.z+=2E-6*e*(Math.random()-0.5);for(var e=[],g=0;g<f.length;){var h=f[g],b=d,k=a[h[0]],l;l=k;var q=a[h[1]],m=a[h[2]],p=new THREE.Vector3,K=new THREE.Vector3;p.subVectors(m,q);K.subVectors(l,q);p.cross(K);p.normalize();l=p;k=l.dot(k);if(l.dot(b)>=k){for(b=0;3>b;b++){k=[h[b],h[(b+1)%3]];l=!0;for(q=0;q<e.length;q++)if(m=e[q],m[0]===k[1]&&m[1]===k[0]){e[q]=e[e.length-
1];e.pop();l=!1;break}l&&e.push(k)}f[g]=f[f.length-1];f.pop()}else g++}for(q=0;q<e.length;q++)f.push([e[q][0],e[q][1],c])}function e(a){var c=a.length();return new THREE.Vector2(a.x/c,a.y/c)}THREE.Geometry.call(this);for(var f=[[0,1,2],[0,2,1]],d=3;d<a.length;d++)c(d);for(var g=0,h=Array(a.length),d=0;d<f.length;d++)for(var k=f[d],l=0;3>l;l++)void 0===h[k[l]]&&(h[k[l]]=g++,this.vertices.push(a[k[l]])),k[l]=h[k[l]];for(d=0;d<f.length;d++)this.faces.push(new THREE.Face3(f[d][0],f[d][1],f[d][2]));for(d=
0;d<this.faces.length;d++)k=this.faces[d],this.faceVertexUvs[0].push([e(this.vertices[k.a]),e(this.vertices[k.b]),e(this.vertices[k.c])]);this.computeFaceNormals();this.computeVertexNormals()};THREE.ConvexGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ConvexGeometry.prototype.constructor=THREE.ConvexGeometry;THREE.Tubex=function(a,c,e,f,d,g){THREE.BufferGeometry.call(this);this.type="Tubex";this.tubularSegments=c||64;this.radius=e||1;this.radialSegments=f||8;this.closed=d||!1;if(a instanceof Array)this.positions=a;else{this.positions=[];c=(new THREE.Vector3).fromArray(a.start);e=(new THREE.Vector3).fromArray(a.end);f=e.clone().sub(c);a=a.numSegment-1;this.positions.push(c);for(d=1;d<a;d++)this.positions.push((new THREE.Vector3(f.x/a*d,f.y/a*d,f.z/a*d)).add(c));this.positions.push(e)}this.path=new THREE.CatmullRomCurve3(this.positions);
this.path.type=g||"catmullrom";this.path.closed=this.closed;this.frames=this.path.computeFrenetFrames(this.tubularSegments,this.closed);this.vertex=new THREE.Vector3;this.normal=new THREE.Vector3;this.uv=new THREE.Vector2;this.vertices=[];this.normals=[];this.uvs=[];this.indices=[];this.generateBufferData();this.setIndex(new (65535<this.indices.length?THREE.Uint32BufferAttribute:THREE.Uint16BufferAttribute)(this.indices,1));this.addAttribute("position",new THREE.Float32BufferAttribute(this.vertices,
3));this.addAttribute("normal",new THREE.Float32BufferAttribute(this.normals,3));this.addAttribute("uv",new THREE.Float32BufferAttribute(this.uvs,2))};THREE.Tubex.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.Tubex.prototype.constructor=THREE.Tubex;THREE.Tubex.prototype.generateBufferData=function(){for(var a=0;a<this.tubularSegments;a++)this.generateSegment(a);this.generateSegment(!1===this.closed?this.tubularSegments:0);this.generateIndicesAndUv()};
THREE.Tubex.prototype.generateSegment=function(a){var c=this.path.getPointAt(a/this.tubularSegments),e=this.frames.normals[a];a=this.frames.binormals[a];for(var f=0;f<=this.radialSegments;f++){var d=f/this.radialSegments*Math.PI*2,g=Math.sin(d),d=-Math.cos(d);this.normal.x=d*e.x+g*a.x;this.normal.y=d*e.y+g*a.y;this.normal.z=d*e.z+g*a.z;this.normal.normalize();this.normals.push(this.normal.x,this.normal.y,this.normal.z);this.vertex.x=c.x+this.radius*this.normal.x;this.vertex.y=c.y+this.radius*this.normal.y;
this.vertex.z=c.z+this.radius*this.normal.z;this.vertices.push(this.vertex.x,this.vertex.y,this.vertex.z)}};
THREE.Tubex.prototype.generateIndicesAndUv=function(){for(var a=0;a<=this.tubularSegments;a++)for(var c=0;c<=this.radialSegments;c++){if(0<c&&0<a){var e=(this.radialSegments+1)*a+(c-1),f=(this.radialSegments+1)*a+c,d=(this.radialSegments+1)*(a-1)+c;this.indices.push((this.radialSegments+1)*(a-1)+(c-1),e,d);this.indices.push(e,f,d)}this.uv.x=a/this.tubularSegments;this.uv.y=c/this.radialSegments;this.uvs.push(this.uv.x,this.uv.y)}};
THREE.Tubex.prototype.updatePath=function(a){this.frames=this.path.computeFrenetFrames(this.tubularSegments,this.closed);this.normals=this.attributes.normal.array;this.vertices=this.attributes.position.array;for(a=0;a<this.tubularSegments;a++)this.updateSegment(a);this.updateSegment(!1===this.closed?this.tubularSegments:0);this.attributes.position.needsUpdate=!0;this.attributes.normal.needsUpdate=!0};
THREE.Tubex.prototype.updateUV=function(){this.uvs=this.attributes.uv.array;for(var a,c,e=0;e<=this.tubularSegments;e++){a=2*e*(this.radialSegments+1);for(var f=0;f<=this.radialSegments;f++)c=2*f,this.uv.x=e/this.tubularSegments,this.uv.y=f/this.radialSegments,this.uvs[a+c]=this.uv.x,this.uvs[a+c+1]=this.uv.y}this.attributes.uv.needsUpdate=!0};
THREE.Tubex.prototype.updateSegment=function(a){for(var c=3*a*(this.radialSegments+1),e=this.path.getPointAt(a/this.tubularSegments),f=this.frames.normals[a],d=this.frames.binormals[a],g=0;g<=this.radialSegments;g++){var h=g/this.radialSegments*Math.PI*2;a=3*g;var k=Math.sin(h),h=-Math.cos(h);this.normal.x=h*f.x+k*d.x;this.normal.y=h*f.y+k*d.y;this.normal.z=h*f.z+k*d.z;this.normal.normalize();this.normals[c+a]=this.normal.x;this.normals[c+a+1]=this.normal.y;this.normals[c+a+2]=this.normal.z;this.vertices[c+
a]=e.x+this.radius*this.normal.x;this.vertices[c+a+1]=e.y+this.radius*this.normal.y;this.vertices[c+a+2]=e.z+this.radius*this.normal.z}};THREE.ShaderShadow={uniforms:Object.assign({},THREE.UniformsLib.lights,{diffuse:{value:new THREE.Color(15658734)},specular:{value:new THREE.Color(1118481)},emissive:{value:new THREE.Color(0)},opacity:{value:0.4}}),fragmentShader:["uniform float opacity;\nvarying vec2 vUv;",THREE.ShaderChunk.common,THREE.ShaderChunk.packing,THREE.ShaderChunk.bsdfs,THREE.ShaderChunk.lights_pars,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.shadowmask_pars_fragment,"void main() {\n   float mask = getShadowMask();\n   vec4 pp = vec4(1.0);\n   vec4 mapping = vec4( pp.rgb, pp.a * opacity );\n   vec4 shadowing = vec4( vec3(0.0), opacity * (1.0 - mask) );\n   gl_FragColor = mix( mapping, shadowing, 1.0 - mask );\n   gl_FragColor = shadowing;\n}"].join("\n"),
vertexShader:["varying vec2 vUv;",THREE.ShaderChunk.common,THREE.ShaderChunk.bsdfs,THREE.ShaderChunk.lights_pars,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\nvUv = uv;\ngl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),lights:!0,transparent:!0};THREE.CarHelper=function(a){this.py=a[1];a=new Float32Array([-0.2,0,0,0.2,0,0,0,0,0,0,0.4,0,0,0,-0.2,0,0,0.2,0.5*a[0],a[1],a[2],0.5*a[0],a[1]+1,a[2],0.5*-a[0],a[1],a[2],0.5*-a[0],a[1]+1,a[2],0.5*-a[0],a[1],-a[2],0.5*-a[0],a[1]+1,-a[2],0.5*a[0],a[1],-a[2],0.5*a[0],a[1]+1,-a[2]]);var c=new Float32Array([1,1,0,1,1,0,1,1,0,0,1,0,1,1,0,1,1,0,1,1,0,1,1,0,1,1,0,1,1,0,1,1,0,1,1,0,1,1,0,1,1,0]);this.geometry=new THREE.BufferGeometry;this.geometry.addAttribute("position",new THREE.BufferAttribute(a,3));this.geometry.addAttribute("color",
new THREE.BufferAttribute(c,3));this.positions=this.geometry.attributes.position.array;this.material=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors,name:"helper"});THREE.LineSegments.call(this,this.geometry,this.material)};THREE.CarHelper.prototype=Object.create(THREE.LineSegments.prototype);THREE.CarHelper.prototype.constructor=THREE.CarHelper;THREE.CarHelper.prototype.dispose=function(){this.geometry.dispose();this.material.dispose()};
THREE.CarHelper.prototype.updateSuspension=function(a,c,e,f){this.positions[22]=this.py-a;this.positions[28]=this.py-c;this.positions[34]=this.py-e;this.positions[40]=this.py-f;this.geometry.attributes.position.needsUpdate=!0};THREE.Terrain=function(a,c){a=void 0==a?{}:a;this.div=void 0==a.div?[64,64]:a.div;this.size=void 0==a.size?[100,10,100]:a.size;this.colorBase={r:1,g:0.7,b:0};this.complexity=void 0==a.complexity?30:a.complexity;this.complexity2=void 0==a.complexity2?60:a.complexity2;this.local=new THREE.Vector3;a.local&&this.local.fromArray(a.local);this.lng=this.div[0]*this.div[1];this.hdata=new Float32Array(this.lng);this.perlin=void 0==c?new Perlin:c;this.colors=new Float32Array(3*this.lng);this.geometry=new THREE.PlaneBufferGeometry(this.size[0],
this.size[2],this.div[0]-1,this.div[1]-1);this.geometry.rotateX(0.5*-Math.PI);this.geometry.computeBoundingSphere();this.geometry.addAttribute("color",new THREE.BufferAttribute(this.colors,3));this.vertices=this.geometry.attributes.position.array;this.material=new THREE.MeshStandardMaterial({vertexColors:THREE.VertexColors,name:"terrain",metalness:1,roughness:0.3,wireframe:!1});this.update();THREE.Mesh.call(this,this.geometry,this.material);this.castShadow=!1;this.receiveShadow=!0};
THREE.Terrain.prototype=Object.create(THREE.Mesh.prototype);THREE.Terrain.prototype.constructor=THREE.Terrain;THREE.Terrain.prototype.dispose=function(){this.geometry.dispose();this.material.dispose()};THREE.Terrain.prototype.setEnvMap=function(a){this.material.envMap=a};THREE.Terrain.prototype.move=function(){this.update()};THREE.Terrain.prototype.clamp=function(a,c,e){a=a<c?c:a;return a>e?e:a};THREE.Terrain.prototype.norm=function(a,c,e){return(a-c)/(e-c)};
THREE.Terrain.prototype.linear=function(a,c,e){return(1-a)*c+a*e};THREE.Terrain.prototype.cubicSCurve=function(a){return a*a*(3-2*a)};THREE.Terrain.prototype.quinticSCurve=function(a){var c=a*a*a,e=c*a;return 6*e*a-15*e+10*c};
THREE.Terrain.prototype.update=function(){for(var a=1/this.complexity,c=1/this.complexity2,e=1/this.div[0],f=(this.div[0]-1)/this.size[0],d=(this.div[1]-1)/this.size[2],g=this.lng,h,k,l,n;g--;)h=3*g,k=g%this.div[0],l=~~(g*e),n=0.5+0.5*this.perlin.noise((k+this.local.x*f)*a,(l+this.local.z*d)*a),k=0.5+0.5*this.perlin.noise((k+100+this.local.x*f)*c,(l+100+this.local.z*d)*c),n=Math.min(n,k),n=this.linear(n,0,0.7),n=this.quinticSCurve(n),this.hdata[g]=n*this.size[1],this.vertices[h+1]=this.hdata[g],this.colors[h]=
n*this.colorBase.r,this.colors[h+1]=n*this.colorBase.g,this.colors[h+2]=n*this.colorBase.b;this.geometry.attributes.position.needsUpdate=!0;this.geometry.attributes.color.needsUpdate=!0;this.geometry.computeVertexNormals()};THREE.ViewUtils={mergeGeometryArray:function(a){for(var c=[],e=a.length;e--;)c[e]=(new THREE.Geometry).fromBufferGeometry(a[e]);for(a=new THREE.Geometry;0<c.length;)e=c.pop(),a.merge(e),e.dispose();a.mergeVertices();c=(new THREE.BufferGeometry).fromGeometry(a);a.dispose();return c},prepaGeometry:function(a,c){var e=!1,f=!1;"mesh"==c&&(f=!0);"convex"==c&&(e=!0);var d,g,h,k=(new THREE.Geometry).fromBufferGeometry(a);k.mergeVertices();var l=a.attributes.position.array.length/3,n=k.vertices.length,u=
k.faces.length;a.realVertices=new Float32Array(3*n);a.realIndices=new (65535<3*u?Uint32Array:Uint16Array)(3*u);for(d=n;d--;)h=k.vertices[d],g=3*d,a.realVertices[g]=h.x,a.realVertices[g+1]=h.y,a.realVertices[g+2]=h.z;if(e)return k.dispose(),a.realVertices;for(d=u;d--;)h=k.faces[d],g=3*d,a.realIndices[g]=h.a,a.realIndices[g+1]=h.b,a.realIndices[g+2]=h.c;k.dispose();if(f){l=[];for(d=a.realIndices.length;d--;)g=3*d,h=3*a.realIndices[d],l[g]=a.realVertices[h],l[g+1]=a.realVertices[h+1],l[g+2]=a.realVertices[h+
2];return l}f=[];k=a.attributes.position.array;for(d=n;d--;)for(g=3*d,f[d]=[],e=l;e--;)h=3*e,k[h]==a.realVertices[g]&&k[h+1]==a.realVertices[g+1]&&k[h+2]==a.realVertices[g+2]&&f[d].push(e);var k=new (65535<n?Uint32Array:Uint16Array)(n),r=new (65535<l?Uint32Array:Uint16Array)(l);for(d=h=0;d<n;d++){g=f[d].length;k[d]=h;for(e=g;e--;)r[h+e]=f[d][e];h+=g}a.numFaces=u;a.numVertices=n;a.maxi=l;a.pPoint=k;a.lPoint=r}};
